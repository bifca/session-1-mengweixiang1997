<?php
class Weather{
	private static $appid = "71311923";
	private static $appsecret = "BXZWG2XQ";
	public function Request($url){
	    // 初始化
	    $curl = curl_init();
	    // 设置url路径
	    curl_setopt($curl, CURLOPT_URL, $url);
	    // 将 curl_exec()获取的信息以文件流的形式返回，而不是直接输出。
	    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
	    // 在启用 CURLOPT_RETURNTRANSFER 时候将获取数据返回
	    curl_setopt($curl, CURLOPT_BINARYTRANSFER, true);
	    // CURLINFO_HEADER_OUT选项可以拿到请求头信息
	    curl_setopt($curl, CURLINFO_HEADER_OUT, true);
	    // 不验证SSL
	    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE);
	    curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE);
	    $data = curl_exec($curl);
	    // 关闭连接
	    curl_close($curl);
	    return $data;
	}
	// get location weather
	public function getLocationWeather(){
		$url = "https://tianqiapi.com/api?version=v1&appid=". self::$appid ."&appsecret=". self::$appsecret;
		return $this->Request($url);
	}
	// get city's weather by id
	public function getCityWeatherById($id){
		$url = "https://tianqiapi.com/api?version=v1&cityid=". $id ."&appid=". self::$appid ."&appsecret=". self::$appsecret;
		return $this->Request($url);
	}
}

if ($_SERVER["REQUEST_METHOD"] === "POST") {
	// initialize a object;
	$weather = new Weather;

	$id = isset($_POST["city_id"]) ? $_POST["city_id"] : "";
	// response location weather
	if($id === ""){
		echo $weather->getLocationWeather();	
		return;	
	}
	echo $weather->getCityWeatherById($id);
	return;






}










?>
<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="css/materialize.min.css">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<style type="text/css">
		.card{margin-top:15px;}
 		html{font-family: GillSans, Calibri, Trebuchet, sans-serif;}
 		.card-text{color:#818181;}
 		.card-title{text-transform:uppercase;}
 		.card-body{position:relative;}
 		.wea{position:absolute;top:15px;right:0px;width:80px;height:80px;}
 		.wea svg{width:80px;height:80px;display:block;position:absolute;top:0px;fill:#818181;}
 		.weather{width:100%;display:flex;margin-top:15px;}
 		.weather .unit{width:calc(100% / 3);}
 		.weather .unit svg, .weather .unit p{display:inline-block;vertical-align:middle;}
 		p{margin-bottom:0px;}

	</style>
</head>
<body>



<div class="container-fluid">
	<div class="row justify-content-md-center">
		

		<div class="card col-12 col-md-6">
		  <div class="card-body">
		    <h5 class="card-title"></h5>
		    <p class="card-text"></p>	   
		    <p class="wea"></p>
		    <div class="weather"></div>
		  </div>
		  <ul class="list-group list-group-flush">
		  </ul>
		  <div class="card-body">
		    <select class="form-control" id="selector">
		      <!-- <option>1</option> -->
		    </select>


		  </div>
		</div>





	</div>
</div>











<script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
<script>
$(function(){
	let weaType = {
		xue: `<svg t="1583246913160" class="icon" viewBox="0 0 1210 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4031" width="200" height="200"><path d="M958.382212 764.803668v-89.159886a207.585192 207.585192 0 1 0-146.708539-387.580699c-50.514155-117.693983-177.01043-183.680367-302.659484-157.875347s-215.774258 136.275255-215.637455 264.321834a273.604585 273.604585 0 0 0 1.559106 28.944871 176.956516 176.956516 0 0 0-53.334923-8.299828c-86.101089 0-155.897032 60.416734-155.897032 134.946476s69.794842 134.946476 155.897032 134.946475a179.944527 179.944527 0 0 0 31.064756-2.692034v85.360229H209.932103v-0.476791c-117.259003-5.468424-209.070579-102.733754-207.576756-219.892263s95.761605-212.050155 213.120366-214.536436c25.196562-140.70941 132.941387-252.343748 272.871061-282.730361 139.930774-30.380745 284.398395 26.487198 365.885616 144.027507 103.995415-23.019461 212.285616 12.567473 282.245501 92.757456a289.836011 289.836011 0 0 1 53.253868 291.795989c-37.13467 99.660287-125.894785 171.076218-231.349914 186.142808z m-554.617765 43.84275l133.020974-68.027048-131.157822-70.00023a38.299507 38.299507 0 0 1-15.825788-54.500859 45.175564 45.175564 0 0 1 58.960688-14.600802l131.165157 70.000229v-128.319083c0-24.000917 19.504413-43.450315 43.545674-43.450316a43.485891 43.485891 0 0 1 43.531002 43.450316v130.802063l132.632207-67.84a46.565593 46.565593 0 0 1 59.466819 14.278051 36.309456 36.309456 0 0 1-15.935816 52.685387l-133.006304 68.027049 131.165157 69.992894a38.261364 38.261364 0 0 1 15.796447 54.486189 45.125685 45.125685 0 0 1-58.95702 14.622808l-131.16149-69.978224v128.275072a43.538338 43.538338 0 0 1-87.076676 0v-130.758052l-132.617536 67.836333a46.574762 46.574762 0 0 1-59.466819-14.091003 36.236103 36.236103 0 0 1 15.921146-52.890774z" fill="#818181" p-id="4032"></path></svg>`,
		lei: `<svg t="1583246921886" class="icon" viewBox="0 0 1210 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4169" width="200" height="200"><path d="M945.85765 727.546132v-88.580401c97.492722-29.726074 159.017077-126.41192 145.069112-227.97937-13.944298-101.561215-99.220172-177.826476-201.066361-179.825696a198.033971 198.033971 0 0 0-82.781891 18.194338c-40.706934-98.741547-136.285158-163.282521-242.499484-163.764814-145.718281 0-263.839175 121.041421-263.839175 270.430625a281.411117 281.411117 0 0 0 1.530865 29.002452 168.600573 168.600573 0 0 0-52.05749-8.314498c-84.053456 0-152.191266 60.537765-152.191266 135.214212s68.137811 135.228883 152.226109 135.228882c4.804585 0 9.532516-0.249398 14.217902-0.638166v83.475072H202.131438v-1.980516C91.25043 711.925731 10.819484 613.42808 16.614327 500.821089s95.908309-202.21616 207.855862-206.683691C252.464413 126.749708 395.938109 3.834132 564.579026 2.750716c113.945673 0.214556 220.369054 57.262212 284.130659 152.299095a279.520458 279.520458 0 0 1 60.805501-6.731186c150.80894 2.496917 274.396791 121.2149 283.899599 272.722154s-98.255587 284.930201-247.557135 306.50682z m-412.944871-122.095129h144.584986l-123.932607 166.315645h103.276561l-247.865215 249.478968 103.276562-207.895473H408.976504z m289.173639 74.84149c-1.162636 27.855587-23.938567 49.828309-51.636447 49.828309s-50.473811-21.972722-51.640114-49.828309c0-27.551175 51.640115-74.84149 51.640114-74.84149s51.636447 47.290315 51.636447 74.84149z m0 207.902808c-1.162636 27.848252-23.938567 49.824642-51.636447 49.824642s-50.473811-21.97639-51.640114-49.824642c0-27.55851 51.640115-74.845158 51.640114-74.845158s51.636447 47.286648 51.636447 74.845158z m0 0" fill="#818181" p-id="4170"></path></svg>`,
		shachen: `<svg t="1583246898333" class="icon" viewBox="0 0 1214 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3893" width="200" height="200"><path d="M1072.095242 342.505922h-608.584692a48.465669 48.465669 0 0 1 0-96.930971h608.584692a48.465669 48.465669 0 0 1 0 96.930971z m-97.826903-243.033364H147.237643a48.639725 48.639725 0 0 1-48.655116-48.651084v-0.333089A48.639359 48.639359 0 0 1 147.237643 1.83217h827.030696a48.648153 48.648153 0 0 1 48.651451 48.658047v0.333089a48.64852 48.64852 0 0 1-48.651451 48.651084zM293.374114 464.378229h632.444313a48.649985 48.649985 0 0 1 48.644122 48.647786v0.340784a48.653283 48.653283 0 0 1-48.644122 48.651451H293.374114a48.651451 48.651451 0 0 1-48.653283-48.651451v-0.340784a48.651451 48.651451 0 0 1 48.653283-48.647786z m0 243.026402h365.203948a48.654749 48.654749 0 0 1 48.647786 48.658779v0.333455a48.64229 48.64229 0 0 1-48.647786 48.647787H293.374114a48.651451 48.651451 0 0 1-48.653283-48.647787v-0.333455a48.662444 48.662444 0 0 1 48.653283-48.658779z m121.664538 219.483013h97.640021a48.470066 48.470066 0 0 1 0 96.929139h-97.683993a48.4697 48.4697 0 0 1 0-96.89616z m0 0" fill="#818181" p-id="3894"></path></svg>`,
		wu: `<svg t="1583246937828" class="icon" viewBox="0 0 1210 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4307" width="200" height="200"><path d="M1158.517731 994.850109H51.814327a48.199519 48.199519 0 0 1-48.141937-48.262235v-0.333754a48.199519 48.199519 0 0 1 48.142303-48.262235h1106.704871a48.197318 48.197318 0 0 1 48.133869 48.262235v0.333754a48.197318 48.197318 0 0 1-48.133869 48.262235z m0-168.952665H51.814327c-26.587324 0-48.141937-21.609628-48.141937-48.262235v-0.330086c0-26.656275 21.554613-48.265903 48.142303-48.265902h1106.704871c26.590258 0 48.133868 21.609628 48.133869 48.265902v0.330086c0 26.652607-21.54361 48.262235-48.133869 48.262235z m0-193.037937H51.814327c-26.587324 0-48.141937-21.60596-48.141937-48.262235v-0.29341a48.19255 48.19255 0 0 1 48.142303-48.254899h1106.704871a48.19255 48.19255 0 0 1 48.133869 48.254899v0.333754a48.19255 48.19255 0 0 1-48.133869 48.262235v-0.040344z m-276.582694-361.906613a228.290384 228.290384 0 0 0-65.008596 9.513444c-57.009513-115.54549-185.89341-176.5109-311.095014-147.164424-125.216275 29.353444-213.764034 141.295496-213.756699 270.206533 0 3.920688 0.295977 7.779026 0.481192 11.666705H28.662831a203.699713 203.699713 0 0 1 155.524034-72.11388c4.648711 0 9.193261 0.385467 13.759083 0.696848 14.861203-146.583106 119.711175-268.142762 262.256596-304.04071s292.250774 21.565616 374.442178 143.711358a276.842361 276.842361 0 0 1 345.58533 231.73208h-85.877364c-34.721375-87.094648-118.856619-144.214556-212.417651-144.207587z m0 0" fill="#818181" p-id="4308"></path></svg>`,
		bingbao: `<svg t="1583247049123" class="icon" viewBox="0 0 1210 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5135" width="200" height="200"><path d="M1189.732126 556.285066c-37.13467 99.660287-125.894785 171.076218-231.349914 186.142808v-89.159885a207.584825 207.584825 0 1 0-146.708539-387.579599c-50.514155-117.693983-177.01043-183.680367-302.659484-157.875347S293.239931 244.088298 293.376734 372.133777a273.604585 273.604585 0 0 0 1.559106 28.944871 176.956516 176.956516 0 0 0-53.334923-8.299829c-86.101089 0-155.897032 60.420401-155.897032 134.946476s69.795576 134.946476 155.897032 134.946476a179.94086 179.94086 0 0 0 31.064756-2.688367v85.360229H209.932103v-0.480458c-117.259003-5.468424-209.070579-102.730086-207.576756-219.892264s95.761605-212.049054 213.120366-214.535335c25.196562-140.70941 132.941387-252.343748 272.871061-282.730361 139.930774-30.380745 284.398395 26.487198 365.885616 144.027507 103.995415-23.019461 212.285616 12.567473 282.245501 92.757456a289.833444 289.833444 0 0 1 53.254235 291.794888z m-713.902579 101.662808a41.572493 41.572493 0 0 1-83.144985 0c0-22.918968 41.57616-62.246877 41.57616-62.246877s41.568825 39.327908 41.568825 62.246877z m0 152.470372a41.572493 41.572493 0 0 1-83.144985 0c0-22.918968 41.57616-62.246877 41.57616-62.246876s41.568825 39.327908 41.568825 62.246876z m0 152.470373a41.572493 41.572493 0 0 1-83.144985 0c0-22.918968 41.57616-62.246877 41.57616-62.246877s41.568825 39.327908 41.568825 62.246877z m173.104413-53.892034h-88.939828v-203.296276h88.939828v203.296276z m180.274613-251.048711c0 22.911633-18.616848 41.491805-41.57616 41.491805s-41.572493-18.580172-41.572493-41.491805c0-22.918968 41.572493-62.246877 41.572493-62.246877s41.57616 39.327908 41.57616 62.246877z m0 152.470372c0 22.911633-18.616848 41.491805-41.57616 41.491806s-41.572493-18.580172-41.572493-41.491806c0-22.918968 41.572493-62.246877 41.572493-62.246876s41.57616 39.327908 41.57616 62.246876z m0 152.470373c0 22.911633-18.616848 41.495473-41.57616 41.495473a41.540218 41.540218 0 0 1-41.572493-41.495473c0-22.918968 41.572493-62.246877 41.572493-62.246877s41.57616 39.327908 41.57616 62.246877z" fill="#818181" p-id="5136"></path></svg>`,
		yun: `<svg t="1583246989613" class="icon" viewBox="0 0 1210 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4445" width="200" height="200"><path d="M1052.079312 583.421799c16.988424 75.666705-1.067278 155.023037-49.058109 215.637823-47.994499 60.603782-120.712436 95.882636-197.585788 95.853295H193.808871c-67.72447-0.055014-130.273926-36.569857-164.086464-95.790946a192.825215 192.825215 0 0 1 0.151106-191.303152c33.913765-59.158739 96.517868-95.567221 164.243805-95.512206 2.006923 0 3.942693 0.234728 5.932378 0.297078 23.541731-117.45192 110.322063-211.686327 224.671542-243.970201 114.356447-32.290842 236.990716 2.824069 317.506017 90.902372 1.067278-80.33192 42.966189-154.466659 110.930888-196.293318a229.606693 229.606693 0 0 1 223.706591-9.626406c-48.306246 11.244928-82.294097 54.97765-81.600917 105.006212 0.685845 50.022693 35.862006 92.787163 84.457994 102.673971s97.448711-15.778842 117.294212-61.62008c33.423037 118.358189-30.012149 242.565868-144.937077 283.745925z m-552.307163-241.25616c-133.849857 0.006235-242.356447 109.515186-242.356447 244.598464 0 8.032092 0.410407 15.987163 1.157501 23.817536a115.155989 115.155989 0 0 0-130.677363 16.152206c-36.016046 32.227393-48.559312 83.559427-31.525777 129.001261 17.035003 45.434499 60.115622 75.527335 108.253158 75.619026 3.438029 0 6.826544-0.157708 10.191587-0.462121v0.462121H784.166877v-0.583152c3.498911 0.205387 6.953811 0.583152 10.504069 0.583152 59.760229 0 115.581433-30.092837 148.806418-80.225559a182.086785 182.086785 0 0 0 16.662006-169.433123c-0.722521-1.760458-1.551404-3.46957-2.32894-5.200688-1.423037-3.194499-2.897421-6.352321-4.50384-9.455129-0.935244-1.892493-1.965845-3.693295-2.996447-5.519771-1.646762-2.934097-3.388883-5.813181-5.19702-8.640916-1.085616-1.690774-2.149226-3.396218-3.282521-5.04298q-3.317364-4.797249-6.939141-9.363439c-0.861891-1.107622-1.6651-2.262923-2.556332-3.344871q-4.956791-6.018567-10.427049-11.575014c-1.096619-1.12596-2.284928-2.160229-3.418223-3.260516q-4.010544-3.900516-8.230144-7.558968c-1.492722-1.272665-3.02212-2.490315-4.547851-3.707966q-4.016046-3.212837-8.226475-6.201948c-1.580745-1.12596-3.172493-2.262923-4.804585-3.326533q-4.703725-3.097307-9.601834-5.890201c-1.35702-0.773868-2.670029-1.621089-4.045386-2.361948-4.687221-2.519656-9.370774-4.844928-14.285387-6.946476-0.935244-0.399771-1.94384-0.722521-2.893754-1.111289q-6.007564-2.475645-12.180172-4.511175c-1.74212-0.564814-3.524585-1.045272-5.285043-1.569742q-8.092607-2.360115-16.383266-3.968367c-3.744642-0.711519-7.489284-1.26533-11.307278-1.738453-1.74212-0.220057-3.458567-0.480458-5.226361-0.652837q-8.400688-0.825215-16.860057-0.861891c-5.18235 0-10.306017 0.407106-15.323324 0.850889-3.16149 0.311748-6.293639 0.66384-9.370774 1.107621a178.337009 178.337009 0 0 0-49.237822 14.369743c-39.162865-87.670831-125.612378-144.040711-220.908195-144.046946z m431.935817-117.110831a205.230946 205.230946 0 0 1 1.415702-23.148928c-75.575014 26.069822-119.945903 104.99961-103.35725 183.846876 79.488367 7.731347 150.687908 52.912779 192.036677 121.860402 44.084814-10.878166 81.424871-40.329169 102.535702-80.874728-107.490659-4.038052-192.583152-93.120917-192.630831-201.682522z m0 0" fill="#818181" p-id="4446"></path></svg>`,
		yu: `<svg t="1583247002800" class="icon" viewBox="0 0 1210 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4721" width="200" height="200"><path d="M959.004607 749.075072v-89.820058c73.884241-23.073009 128.938911-85.363897 142.963897-161.745788 14.024986-76.389226-15.293983-154.279977-76.132493-202.276309a207.643874 207.643874 0 0 0-213.796676-26.439152c-50.605845-118.569077-177.322178-185.045456-303.191289-159.050086S292.694556 247.031564 292.831725 376.030258a277.158877 277.158877 0 0 0 1.561673 29.161261 176.356493 176.356493 0 0 0-53.428447-8.362178c-86.252195 0-156.170269 60.867851-156.170269 135.947736s69.918074 135.947736 156.170269 135.947737a179.133616 179.133616 0 0 0 31.117204-2.706705v85.994728H209.240756v-0.484126c-117.46439-5.508768-209.437341-103.492951-207.940951-221.524356s95.927748-213.626132 213.492264-216.132951c25.242774-141.753582 133.174648-254.217536 273.350785-284.829708s284.894991 26.683049 366.528917 145.096986c104.178797-23.192206 212.659713 12.659163 282.736963 93.446602 70.084585 80.781203 90.549914 193.566074 53.349226 293.963553s-126.114842 172.348883-231.753353 187.525501z m-478.767679-17.707278c0 23.091347-18.646189 41.807221-41.642177 41.80722-23.003324 0-41.649513-18.715874-41.649513-41.80722 0-23.084011 41.649513-62.708997 41.649513-62.708997s41.642178 39.624986 41.642177 62.708997z m0 146.31977c0 23.087679-18.646189 41.799885-41.642177 41.799886-23.003324 0-41.649513-18.712206-41.649513-41.799886s41.649513-62.708997 41.649513-62.708997 41.642178 39.624986 41.642177 62.708997z m166.587049-62.708997c0 23.087679-18.646189 41.807221-41.642178 41.807221-23.003324 0-41.653181-18.719542-41.65318-41.807221s41.653181-62.708997 41.65318-62.708997 41.642178 39.624986 41.642178 62.708997z m0 146.316103c0 23.091347-18.646189 41.803553-41.642178 41.803553-23.003324 0-41.653181-18.712206-41.65318-41.803553 0-23.084011 41.653181-62.708997 41.65318-62.708997s41.642178 39.624986 41.642178 62.708997z m187.411805-229.926876c0 23.091347-18.646189 41.807221-41.649513 41.80722s-41.649513-18.715874-41.649513-41.80722c0-23.084011 41.649513-62.708997 41.649513-62.708997s41.649513 39.624986 41.649513 62.708997z m0 146.31977c0 23.087679-18.646189 41.799885-41.649513 41.799886s-41.649513-18.712206-41.649513-41.799886 41.649513-62.708997 41.649513-62.708997 41.649513 39.624986 41.649513 62.708997z m0 0" fill="#818181" p-id="4722"></path></svg>`,
		yin: `<svg t="1583247018052" class="icon" viewBox="0 0 1210 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4859" width="200" height="200"><path d="M1026.457307 686.791519c-34.526991 100.698223-128.847221 168.29616-234.845158 168.321833H190.817559c-66.524791-0.055014-127.966991-35.76298-161.180241-93.678395a187.858155 187.858155 0 0 1 0.148539-187.089054c33.313375-57.853066 94.808023-93.462006 161.335014-93.406992 1.971347 0 3.873009 0.23106 5.827484 0.289742 18.683599-92.677135 78.170957-171.847152 161.767427-215.287197a309.349593 309.349593 0 0 1 268.359886-8.213639c42.845158-58.448688 111.814785-91.670372 183.993581-88.639817 72.189799 3.028722 138.159312 41.908814 176.009169 103.738682 3.766648-0.207221 7.544298-0.326052 11.36596-0.326052 108.935702 0.010636 199.243553 84.802017 206.626476 193.998854s-70.686074 205.47851-178.613181 220.292035zM491.362292 314.546613c-131.478739 0.005868-238.06533 107.101524-238.065329 239.205593 0 7.856046 0.403438 15.635072 1.136963 23.296734a113.512894 113.512894 0 0 0-128.364562 15.792779c-35.38008 31.519542-47.700722 81.721948-30.967198 126.155186s59.050544 73.865903 106.336092 73.957594c3.376779 0 6.705146-0.165043 10.012607-0.451118v0.451118H770.721375v-0.572149c3.436562 0.201719 6.829112 0.572149 10.31702 0.572149 72.017421-0.058682 136.725272-44.231519 163.30086-111.488367a176.931576 176.931576 0 0 0 12.257192-58.703954c0.088023-2.299599 0.337421-4.536848 0.337421-6.843783 0.23106-60.207679-30.114842-116.377307-80.493295-148.982464a174.857536 174.857536 0 0 0-168.288825-12.05914 239.932883 239.932883 0 0 0-56.187966-77.518854q-4.505673-4.144413-9.198395-8.039427c-1.518395-1.257994-3.011117-2.537994-4.602866-3.755278-3.678625-2.921994-7.518625-5.702785-11.391633-8.403988-1.081948-0.75553-2.130888-1.560206-3.227507-2.303634a236.365387 236.365387 0 0 0-132.181089-40.307163z m496.764699 41.404516a132.899576 132.899576 0 0 0-45.243782 8.032092 154.527175 154.527175 0 0 0-238.487106-56.954499 313.701593 313.701593 0 0 1 47.785444 52.080229 247.573272 247.573272 0 0 1 200.541891 56.463404 250.103931 250.103931 0 0 1 87.267393 189.997479c0 3.564928-0.124699 7.118854-0.267736 10.647106 59.235759-24.793123 92.831175-88.132951 80.298911-151.366419S1052.29937 356.052722 988.126991 355.951129z m0 0" fill="#818181" p-id="4860"></path></svg>`,
		qing: `<svg t="1583247026742" class="icon" viewBox="0 0 1210 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4997" width="200" height="200"><path d="M605.165295 1022.347736c-206.23404-0.018338-392.155324-124.317708-471.109685-314.95702S98.66416 297.287152 244.423519 151.307736c145.767794-145.984183 365.051232-189.759817 555.642865-110.919885a266.034613 266.034613 0 1 0 313.104871 427.608023c1.243324 14.538453 1.973181 29.205272 1.973181 44.05914-0.033009 281.820057-228.338797 510.268883-509.979141 510.294556z m332.653295-377.240573a377.117708 377.117708 0 0 1-332.880687-554.195255c-206.824527 5.631633-377.04949 164.567656-396.964677 370.638121s116.725364 394.698453 318.635278 439.883553 405.83702-67.23851 475.540172-262.161605a377.628607 377.628607 0 0 1-64.330086 5.835186z m0 0" fill="#818181" p-id="4998"></path></svg>`,
	};

	$("#selector").change(function(){
		let val  = $(this).val()
		let head = location.href.split("?")[0];
		let url  = head + "?city_id=" + val;
		location.href = url;
	})
	





	function GetQueryString(name){
		let reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
		let r = window.location.search.substr(1).match(reg);
		if(r!=null)return unescape(r[2]); return null;
	}




	// get location weather
	$.ajax({
		type:"post",
		url:"index.php",
		data: {city_id: GetQueryString("city_id")},
		success: res => {
			let data = JSON.parse(res);
			$(".card-title").html(data.city);
			$(".card-text").html(data.data[0].week + "   " + data.data[0].date);
			$(".wea").html(weaType[data.data[0].wea_img]);
			for (let i = 0; i < 3; i++) {
				if(i === 0){i = ""}
				let temp = data.data[0]["tem" + i];
				$(".weather").append(				
				`<div class="unit">
			    	<svg t="1583244615549" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6181" width="30" height="30"><path d="M512.2 12.2c-0.2-0.2-0.2-0.2-0.2 0-8.4 8.4-390.8 387.2-377.2 625.8 0.8 206.7 169 374.1 376.6 374.1h1.2c207.5 0 375.8-167.3 376.6-374.1 13.6-238.6-368.6-617.4-377-625.8z m319.9 624.9c-0.4 175.6-143.3 317.6-319.3 317.6h-1.7c-176 0-318.7-142.1-319.1-317.6h-0.2C179.5 431 511.4 86.3 511.4 86.3l0.2 0.2v0.4l0.2-0.2 0.2 0.2v-0.4l0.2-0.2c0.2-0.2 333.7 343.2 319.9 550.8zM512.2 12.2c0-0.3-0.2-0.3 0 0zM223.4 634.4c0 159.7 129.7 289.1 289.9 289.1 134.7 0 247.1-101.4 279.6-225.6-66.9-51.1-234.7-37.6-234.7-37.6-135.5 0-247.7-61.2-319.6-118.9-9.9 29.4-15.2 60.6-15.2 93z" p-id="6182" fill="#818181"></path></svg>
			    	<p style="text-align:center;" id="weath">${temp}</p>
			    </div>`);
			}

			for (let i = 1; i < data.data.length; i++) {
				let datas = data.data;
				$(".list-group").append(
					`<div class="list-group-item">${datas[i].day} <span class="float-right">${datas[i].wea}</span></div>`
				)

			}
		}
	})






	// load city's id
	$.ajax({
		type:"get",
		url:"city.json",
		success:data => {
			for (let i = 0; i < data.length; i++) {
				$("#selector").append(`<option value="${data[i].id}">${data[i].cityZh}</option>`)
			}
			$("#selector").val(GetQueryString("city_id"))
		}
	})	
})
</script>
</body>
</html>